import{c as D,j as e,B as C}from"./createLucideIcon.mgYnVIzO.js";import{r as m}from"./index.CG1BCU3E.js";import{C as _,a as A,b as J,c as Z,d as W}from"./card.C5nyZeWf.js";import{D as F,b as $,c as k,d as P,e as L,L as f,I as E,h as q,g as G,f as V,R as K,i as S,F as I,j as T,k as H,l as Q,m as X,P as Y,T as ee,B as se}from"./exportUtils.DVQzN8bT.js";/**
 * @license lucide-react v0.363.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ae=D("Folder",[["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}]]);/**
 * @license lucide-react v0.363.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const te=D("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.363.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const re=D("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a2.121 2.121 0 1 1 3 3L12 15l-4 1 1-4Z",key:"1lpok0"}]]),w=["#6B7280","#EF4444","#10B981","#3B82F6","#8B5CF6","#F59E0B","#EC4899","#06B6D4","#84CC16","#F97316"];function ne({open:n,onClose:s,onSuccess:N,language:u="zh"}){const[x,h]=m.useState(""),[p,j]=m.useState(""),[i,g]=m.useState(w[0]),[a,v]=m.useState(!1),o=u==="en"?{title:"Create New Group",description:"Create a new group to organize your domains",name:"Group Name",namePlaceholder:"Enter group name",nameRequired:"Group name is required",desc:"Description",descPlaceholder:"Enter description (optional)",color:"Color",cancel:"Cancel",create:"Create",creating:"Creating...",success:"Group created successfully",error:"Failed to create group"}:{title:"创建新分组",description:"创建新的分组来组织您的域名",name:"分组名称",namePlaceholder:"请输入分组名称",nameRequired:"分组名称不能为空",desc:"描述",descPlaceholder:"请输入描述（可选）",color:"颜色",cancel:"取消",create:"创建",creating:"创建中...",success:"分组创建成功",error:"创建分组失败"},t=async d=>{if(d.preventDefault(),!x.trim()){alert(o.nameRequired);return}try{v(!0),await G.createGroup({name:x.trim(),description:p.trim(),color:i}),alert(o.success),N(),c()}catch(l){console.error("创建分组失败:",l),alert(`${o.error}: ${l.message||"未知错误"}`)}finally{v(!1)}},c=()=>{h(""),j(""),g(w[0]),v(!1),s()};return e.jsx(F,{open:n,onOpenChange:c,children:e.jsx($,{className:"sm:max-w-md",children:e.jsxs("form",{onSubmit:t,children:[e.jsxs(k,{children:[e.jsx(P,{children:o.title}),e.jsx(L,{children:o.description})]}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(f,{htmlFor:"name",children:o.name}),e.jsx(E,{id:"name",value:x,onChange:d=>h(d.target.value),placeholder:o.namePlaceholder,maxLength:50,required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(f,{htmlFor:"description",children:o.desc}),e.jsx(E,{id:"description",value:p,onChange:d=>j(d.target.value),placeholder:o.descPlaceholder,maxLength:200})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(f,{children:o.color}),e.jsx("div",{className:"flex flex-wrap gap-2",children:w.map(d=>e.jsx("button",{type:"button",className:`w-8 h-8 rounded-full border-2 transition-all ${i===d?"border-gray-900 scale-110":"border-gray-300 hover:border-gray-500"}`,style:{backgroundColor:d},onClick:()=>g(d)},d))})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(f,{children:u==="en"?"Preview":"预览"}),e.jsxs("div",{className:"flex items-center gap-3 p-3 border rounded-lg bg-gray-50",children:[e.jsx("div",{className:"w-4 h-4 rounded-full",style:{backgroundColor:i}}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-medium",children:x||o.namePlaceholder}),p&&e.jsx("div",{className:"text-sm text-gray-600",children:p})]})]})]})]}),e.jsxs(q,{children:[e.jsx(C,{type:"button",variant:"outline",onClick:c,disabled:a,children:o.cancel}),e.jsx(C,{type:"submit",disabled:a||!x.trim(),children:a?o.creating:o.create})]})]})})})}function le({open:n,group:s,onClose:N,onSuccess:u,language:x="zh"}){const[h,p]=m.useState(""),[j,i]=m.useState(""),[g,a]=m.useState(w[0]),[v,o]=m.useState(!1),t=x==="en"?{title:"Edit Group",description:"Update group information",name:"Group Name",namePlaceholder:"Enter group name",nameRequired:"Group name is required",desc:"Description",descPlaceholder:"Enter description (optional)",color:"Color",cancel:"Cancel",save:"Save Changes",saving:"Saving...",success:"Group updated successfully",error:"Failed to update group"}:{title:"编辑分组",description:"更新分组信息",name:"分组名称",namePlaceholder:"请输入分组名称",nameRequired:"分组名称不能为空",desc:"描述",descPlaceholder:"请输入描述（可选）",color:"颜色",cancel:"取消",save:"保存更改",saving:"保存中...",success:"分组更新成功",error:"更新分组失败"};m.useEffect(()=>{n&&s&&(p(s.name),i(s.description||""),a(s.color))},[n,s]);const c=async l=>{if(l.preventDefault(),!h.trim()){alert(t.nameRequired);return}try{o(!0),await G.updateGroup(s.id,{name:h.trim(),description:j.trim(),color:g}),alert(t.success),u(),d()}catch(y){console.error("更新分组失败:",y),alert(`${t.error}: ${y.message||"未知错误"}`)}finally{o(!1)}},d=()=>{o(!1),N()};return e.jsx(F,{open:n,onOpenChange:d,children:e.jsx($,{className:"sm:max-w-md",children:e.jsxs("form",{onSubmit:c,children:[e.jsxs(k,{children:[e.jsx(P,{children:t.title}),e.jsx(L,{children:t.description})]}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(f,{htmlFor:"name",children:t.name}),e.jsx(E,{id:"name",value:h,onChange:l=>p(l.target.value),placeholder:t.namePlaceholder,maxLength:50,required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(f,{htmlFor:"description",children:t.desc}),e.jsx(E,{id:"description",value:j,onChange:l=>i(l.target.value),placeholder:t.descPlaceholder,maxLength:200})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(f,{children:t.color}),e.jsx("div",{className:"flex flex-wrap gap-2",children:w.map(l=>e.jsx("button",{type:"button",className:`w-8 h-8 rounded-full border-2 transition-all ${g===l?"border-gray-900 scale-110":"border-gray-300 hover:border-gray-500"}`,style:{backgroundColor:l},onClick:()=>a(l)},l))})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(f,{children:x==="en"?"Preview":"预览"}),e.jsxs("div",{className:"flex items-center gap-3 p-3 border rounded-lg bg-gray-50",children:[e.jsx("div",{className:"w-4 h-4 rounded-full",style:{backgroundColor:g}}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-medium",children:h||t.namePlaceholder}),j&&e.jsx("div",{className:"text-sm text-gray-600",children:j})]})]})]})]}),e.jsxs(q,{children:[e.jsx(C,{type:"button",variant:"outline",onClick:d,disabled:v,children:t.cancel}),e.jsx(C,{type:"submit",disabled:v||!h.trim(),children:v?t.saving:t.save})]})]})})})}function ie({open:n,group:s,onClose:N,language:u="zh"}){const[x,h]=m.useState("csv"),[p,j]=m.useState(""),[i,g]=m.useState(!1),a=u==="en"?{title:`Export Group: ${s.name}`,description:`Export ${s.domainCount} domains from this group`,format:"Export Format",filename:"File Name",export:"Export",exporting:"Exporting...",cancel:"Cancel",csvDesc:"Excel compatible spreadsheet",pdfDesc:"Professional formatted report",jsonDesc:"Complete data backup",filenameHelp:"File name (without extension)",exportSuccess:"Group export completed successfully",exportError:"Group export failed",noDomains:"This group has no domains to export",clientExport:"Client-side Export",clientExportDesc:"Faster processing, no server storage required"}:{title:`导出分组: ${s.name}`,description:`导出该分组中的 ${s.domainCount} 个域名`,format:"导出格式",filename:"文件名",export:"导出",exporting:"导出中...",cancel:"取消",csvDesc:"Excel兼容的电子表格",pdfDesc:"专业格式的报告",jsonDesc:"完整数据备份",filenameHelp:"文件名（不含扩展名）",exportSuccess:"分组导出成功完成",exportError:"分组导出失败",noDomains:"该分组没有域名可导出",clientExport:"前端导出",clientExportDesc:"处理更快，无需服务器存储空间"};m.useEffect(()=>{n&&s&&j(`${s.name}_domains`)},[n,s]);const v=async()=>{if(s.domainCount===0){alert(a.noDomains);return}g(!0);try{console.log(`获取分组域名数据: ${s.name}`);const c=await G.getGroupDomains(s.id);if(c.length===0){alert(a.noDomains);return}const d=["domain","registrar","expiresAt","dnsProvider","status","lastCheck"];console.log(`开始前端分组导出: 格式=${x}, 字段=${d.length}个, 域名=${c.length}个`);const l=await X.export(x,c,d,p.trim()||`${s.name}_domains`,u,{title:u==="en"?`${s.name} Domain Report`:`${s.name} 域名报告`});l.success&&(console.log(a.exportSuccess,l),setTimeout(()=>{let y=`✅ ${a.exportSuccess}

`;y+=`分组：${s.name}
`,y+=`文件：${l.filename}
`,y+=`记录数：${l.totalRecords}
`,y+=`字段数：${l.selectedFields}`,x==="pdf"&&l.note&&(y+=`

💡 ${l.note}`),alert(y)},100),N())}catch(c){console.error(a.exportError,c),alert(`❌ ${a.exportError}

错误详情：${c instanceof Error?c.message:"未知错误"}`)}finally{g(!1)}},t={csv:I,pdf:T,json:H}[x];return e.jsx(F,{open:n,onOpenChange:N,children:e.jsxs($,{className:"sm:max-w-lg",children:[e.jsxs(k,{children:[e.jsxs(P,{className:"flex items-center gap-2",children:[e.jsx(V,{className:"h-5 w-5"}),a.title]}),e.jsx(L,{children:a.description})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx(f,{className:"text-base font-medium",children:a.format}),e.jsxs(K,{value:x,onValueChange:c=>h(c),className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center space-x-3 p-3 border rounded-lg hover:bg-gray-50",children:[e.jsx(S,{value:"csv",id:"csv"}),e.jsx(I,{className:"h-5 w-5 text-green-600"}),e.jsxs("div",{className:"flex-1",children:[e.jsx(f,{htmlFor:"csv",className:"font-medium cursor-pointer",children:"CSV"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:a.csvDesc})]})]}),e.jsxs("div",{className:"flex items-center space-x-3 p-3 border rounded-lg hover:bg-gray-50",children:[e.jsx(S,{value:"pdf",id:"pdf"}),e.jsx(T,{className:"h-5 w-5 text-red-600"}),e.jsxs("div",{className:"flex-1",children:[e.jsx(f,{htmlFor:"pdf",className:"font-medium cursor-pointer",children:"PDF"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:a.pdfDesc})]})]}),e.jsxs("div",{className:"flex items-center space-x-3 p-3 border rounded-lg hover:bg-gray-50",children:[e.jsx(S,{value:"json",id:"json"}),e.jsx(H,{className:"h-5 w-5 text-blue-600"}),e.jsxs("div",{className:"flex-1",children:[e.jsx(f,{htmlFor:"json",className:"font-medium cursor-pointer",children:"JSON"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:a.jsonDesc})]})]})]})]}),e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-3",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:s.color}}),e.jsx("span",{className:"text-sm font-medium text-blue-800",children:s.name})]}),e.jsxs("p",{className:"text-sm text-blue-700",children:["📋 ",u==="en"?`Will export ${s.domainCount} domains from this group`:`将导出该分组中的 ${s.domainCount} 个域名`]})]}),e.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full"}),e.jsx("span",{className:"text-sm font-medium text-green-800",children:a.clientExport})]}),e.jsxs("p",{className:"text-sm text-green-700 mt-1",children:["⚡ ",a.clientExportDesc]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(f,{htmlFor:"filename",className:"text-base font-medium",children:a.filename}),e.jsx(E,{id:"filename",value:p,onChange:c=>j(c.target.value),placeholder:`${s.name}_domains`}),e.jsx("p",{className:"text-sm text-muted-foreground",children:a.filenameHelp})]})]}),e.jsxs(q,{className:"gap-2",children:[e.jsx(C,{variant:"outline",onClick:N,disabled:i,children:a.cancel}),e.jsx(C,{onClick:v,disabled:i||s.domainCount===0,className:"gap-2",children:i?e.jsxs(e.Fragment,{children:[e.jsx(Q,{className:"h-4 w-4 animate-spin"}),a.exporting]}):e.jsxs(e.Fragment,{children:[e.jsx(t,{className:"h-4 w-4"}),a.export]})})]})]})})}function xe({language:n="zh"}){const[s,N]=m.useState([]),[u,x]=m.useState([]),[h,p]=m.useState(!0),[j,i]=m.useState(!1),[g,a]=m.useState(null),[v,o]=m.useState(null),t=n==="en"?{title:"Group Management",description:"Organize and manage your domain groups",createGroup:"Create Group",editGroup:"Edit Group",deleteGroup:"Delete Group",exportGroup:"Export Group",viewStats:"View Statistics",domains:"domains",noDomains:"No domains",defaultGroups:"System Groups",customGroups:"Custom Groups",loading:"Loading groups...",deleteConfirm:"Are you sure you want to delete this group? This action cannot be undone.",deleteSuccess:"Group deleted successfully",deleteError:"Failed to delete group",systemGroupError:"Cannot delete system default groups"}:{title:"分组管理",description:"组织和管理您的域名分组",createGroup:"创建分组",editGroup:"编辑分组",deleteGroup:"删除分组",exportGroup:"导出分组",viewStats:"查看统计",domains:"个域名",noDomains:"暂无域名",defaultGroups:"系统分组",customGroups:"自定义分组",loading:"加载分组中...",deleteConfirm:"确定要删除这个分组吗？此操作不可撤销。",deleteSuccess:"分组删除成功",deleteError:"删除分组失败",systemGroupError:"无法删除系统默认分组"};m.useEffect(()=>{c(),d()},[]);const c=async()=>{try{p(!0);const r=await G.getGroups();N(r)}catch(r){console.error("获取分组失败:",r)}finally{p(!1)}},d=async()=>{try{const r=await G.getGroupStats();x(r)}catch(r){console.error("获取分组统计失败:",r)}},l=async r=>{if(["default","important","development"].includes(r.id)){alert(t.systemGroupError);return}if(confirm(t.deleteConfirm))try{await G.deleteGroup(r.id),alert(t.deleteSuccess),c(),d()}catch(B){console.error("删除分组失败:",B),alert(`${t.deleteError}: ${B.message||"未知错误"}`)}},y=()=>{c(),d(),i(!1)},O=()=>{c(),d(),a(null)},U=s.filter(r=>["default","important","development"].includes(r.id)),R=s.filter(r=>!["default","important","development"].includes(r.id)),z=r=>u.find(b=>b.id===r);return h?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto mb-2"}),e.jsx("p",{className:"text-gray-600",children:t.loading})]})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:t.title}),e.jsx("p",{className:"text-gray-600",children:t.description})]}),e.jsxs(C,{onClick:()=>i(!0),className:"gap-2",children:[e.jsx(Y,{className:"h-4 w-4"}),t.createGroup]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(te,{className:"h-5 w-5 text-gray-500"}),e.jsx("h2",{className:"text-lg font-semibold text-gray-800",children:t.defaultGroups})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:U.map(r=>{const b=z(r.id);return e.jsx(M,{group:r,stats:b,isSystemGroup:!0,language:n,labels:t,onEdit:()=>a(r),onDelete:()=>l(r),onExport:()=>o(r)},r.id)})})]}),R.length>0&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ae,{className:"h-5 w-5 text-gray-500"}),e.jsx("h2",{className:"text-lg font-semibold text-gray-800",children:t.customGroups})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:R.map(r=>{const b=z(r.id);return e.jsx(M,{group:r,stats:b,isSystemGroup:!1,language:n,labels:t,onEdit:()=>a(r),onDelete:()=>l(r),onExport:()=>o(r)},r.id)})})]}),e.jsx(ne,{open:j,onClose:()=>i(!1),onSuccess:y,language:n}),g&&e.jsx(le,{open:!0,group:g,onClose:()=>a(null),onSuccess:O,language:n}),v&&e.jsx(ie,{open:!0,group:v,onClose:()=>o(null),language:n})]})}function M({group:n,stats:s,isSystemGroup:N,language:u,labels:x,onEdit:h,onDelete:p,onExport:j}){const i={normal:s?.normalCount||0,expiring:s?.expiringCount||0,expired:s?.expiredCount||0,failed:s?.failedCount||0};return e.jsxs(_,{className:"relative group hover:shadow-md transition-shadow",children:[e.jsx(A,{className:"pb-3",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3 flex-1",children:[e.jsx("div",{className:"w-4 h-4 rounded-full flex-shrink-0",style:{backgroundColor:n.color}}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx(J,{className:"text-lg truncate",children:n.name}),n.description&&e.jsx(Z,{className:"text-sm truncate",children:n.description})]})]}),e.jsxs("div",{className:"flex items-center gap-1 opacity-0 group-hover:opacity-100 transition-opacity",children:[e.jsx(C,{variant:"ghost",size:"sm",onClick:h,children:e.jsx(re,{className:"h-3 w-3"})}),n.domainCount>0&&e.jsx(C,{variant:"ghost",size:"sm",onClick:j,children:e.jsx(V,{className:"h-3 w-3"})}),!N&&e.jsx(C,{variant:"ghost",size:"sm",onClick:p,className:"text-red-600 hover:text-red-700",children:e.jsx(ee,{className:"h-3 w-3"})})]})]})}),e.jsx(W,{className:"pt-0",children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:u==="en"?"Domains":"域名数量"}),e.jsx(se,{variant:"secondary",children:n.domainCount>0?`${n.domainCount} ${x.domains}`:x.noDomains})]}),n.domainCount>0&&e.jsxs("div",{className:"grid grid-cols-2 gap-2 text-xs",children:[i.normal>0&&e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-green-600",children:u==="en"?"Normal":"正常"}),e.jsx("span",{className:"font-medium",children:i.normal})]}),i.expiring>0&&e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-yellow-600",children:u==="en"?"Expiring":"即将到期"}),e.jsx("span",{className:"font-medium",children:i.expiring})]}),i.expired>0&&e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-red-600",children:u==="en"?"Expired":"已过期"}),e.jsx("span",{className:"font-medium",children:i.expired})]}),i.failed>0&&e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-gray-600",children:u==="en"?"Failed":"失败"}),e.jsx("span",{className:"font-medium",children:i.failed})]})]})]})})]})}export{xe as GroupManagement};
