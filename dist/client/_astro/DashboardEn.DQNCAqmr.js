import{j as e,B as g}from"./createLucideIcon.mgYnVIzO.js";import{r}from"./index.CG1BCU3E.js";import{D as T,a as k,P as S,b as R,c as E,d as L,e as F,I,f as U,g as o}from"./exportUtils.DVQzN8bT.js";import{T as A,a as O,b as w,c as y,d as B,D as V,R as C,e as P}from"./DataExportDialog.TQ3nz2F0.js";import"./card.C5nyZeWf.js";function $({onImport:i,isLoading:l=!1}){const[D,c]=r.useState(!1),[d,x]=r.useState(""),[u,p]=r.useState(""),[h,f]=r.useState(null),[j,v]=r.useState("lines"),b=async()=>{let t=[];switch(j){case"lines":t=d.split(`
`).map(s=>s.trim()).filter(s=>s.length>0);break;case"string":t=u.split(",").map(s=>s.trim()).filter(s=>s.length>0);break;case"file":if(h){const s=await h.text();h.name.endsWith(".csv")?t=s.split(`
`).slice(1).map(a=>a.split(",")[0]).map(a=>a.trim().replace(/"/g,"")).filter(a=>a.length>0):t=s.split(`
`).map(a=>a.trim()).filter(a=>a.length>0)}break}t.length>0&&(await i(t),c(!1),x(""),p(""),f(null))},N=()=>{const t=`domain
example.com
google.com
github.com`,s=new Blob([t],{type:"text/csv"}),a=window.URL.createObjectURL(s),n=document.createElement("a");n.href=a,n.download="domain-template.csv",n.click(),window.URL.revokeObjectURL(a)};return e.jsxs(T,{open:D,onOpenChange:c,children:[e.jsx(k,{asChild:!0,children:e.jsxs(g,{children:[e.jsx(S,{className:"h-4 w-4 mr-2"}),"Add Domains"]})}),e.jsxs(R,{className:"sm:max-w-[600px]",children:[e.jsxs(E,{children:[e.jsx(L,{children:"Import Domains"}),e.jsx(F,{children:"Choose an import method to batch add domains for monitoring"})]}),e.jsxs(A,{value:j,onValueChange:v,className:"w-full",children:[e.jsxs(O,{className:"grid w-full grid-cols-3",children:[e.jsx(w,{value:"lines",children:"Line by Line"}),e.jsx(w,{value:"file",children:"File Import"}),e.jsx(w,{value:"string",children:"String Import"})]}),e.jsx(y,{value:"lines",className:"space-y-4",children:e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Domain List (one per line)"}),e.jsx(B,{placeholder:`example.com
google.com
github.com`,value:d,onChange:t=>x(t.target.value),rows:8})]})}),e.jsx(y,{value:"file",className:"space-y-4",children:e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Upload File"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(I,{type:"file",accept:".csv,.txt",onChange:t=>f(t.target.files?.[0]||null)}),e.jsxs(g,{type:"button",variant:"outline",size:"sm",onClick:N,children:[e.jsx(U,{className:"h-4 w-4 mr-2"}),"Download Template"]})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Supports CSV and TXT formats. For CSV files, ensure domains are in the first column."})]})}),e.jsx(y,{value:"string",className:"space-y-4",children:e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Domain String (comma separated)"}),e.jsx(I,{placeholder:"example.com, google.com, github.com",value:u,onChange:t=>p(t.target.value)})]})})]}),e.jsxs("div",{className:"flex justify-end space-x-2",children:[e.jsx(g,{variant:"outline",onClick:()=>c(!1),children:"Cancel"}),e.jsx(g,{onClick:b,disabled:l,children:l?"Importing...":"Import Domains"})]})]})]})}function z({onExportComplete:i}){return e.jsx(V,{language:"en",onExportComplete:i})}function J(){const[i,l]=r.useState([]),[D,c]=r.useState(!1),[d,x]=r.useState(!1),[u,p]=r.useState(!0);r.useEffect(()=>{(async()=>{try{const a=await o.getDomains();l(a)}catch(a){console.error("Failed to load domains:",a)}finally{p(!1)}})()},[]);const h=async s=>{c(!0);try{const a=await o.importDomains(s),n=await o.getDomains();return l(n),a}catch(a){return console.error("Failed to import domains:",a),{success:[],errors:[`Import failed: ${a instanceof Error?a.message:"Unknown error"}`],total:s.length}}finally{c(!1)}},f=async s=>{const a=i.find(n=>n.id===s);if(a)try{await o.toggleNotifications(s,!a.notifications),l(n=>n.map(m=>m.id===s?{...m,notifications:!m.notifications}:m))}catch(n){console.error("Failed to toggle notifications:",n)}},j=async s=>{try{await o.refreshDomain(s);const a=await o.getDomains();l(a)}catch(a){console.error("Failed to refresh domain:",a)}},v=async s=>{try{const a=await o.deleteDomains(s);a.success&&(console.log(a.message),l(n=>n.filter(m=>!s.includes(m.id))))}catch(a){console.error("Failed to delete domains:",a)}},b=async()=>{try{const s=await o.getDomains();l(s)}catch(s){console.error("Failed to refresh data:",s)}},N=async()=>{x(!0);try{const s=await o.recheckAllDomains();console.log(s.message);const a=await o.getDomains();l(a)}catch(s){console.error("Failed to recheck domains:",s)}finally{x(!1)}},t={total:i.length,normal:i.filter(s=>s.status==="normal").length,expiring:i.filter(s=>s.status==="expiring").length,expired:i.filter(s=>s.status==="expired").length,failed:i.filter(s=>s.status==="failed").length};return u?e.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:e.jsxs("div",{className:"text-center",children:[e.jsx(C,{className:"h-8 w-8 animate-spin mx-auto mb-4 text-muted-foreground"}),e.jsx("p",{className:"text-muted-foreground",children:"Loading domain data..."})]})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-4",children:[e.jsxs("div",{className:"bg-card p-4 rounded-lg border",children:[e.jsx("div",{className:"text-2xl font-bold",children:t.total}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Total Domains"})]}),e.jsxs("div",{className:"bg-card p-4 rounded-lg border",children:[e.jsx("div",{className:"text-2xl font-bold text-green-600",children:t.normal}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Normal"})]}),e.jsxs("div",{className:"bg-card p-4 rounded-lg border",children:[e.jsx("div",{className:"text-2xl font-bold text-yellow-600",children:t.expiring}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Expiring"})]}),e.jsxs("div",{className:"bg-card p-4 rounded-lg border",children:[e.jsx("div",{className:"text-2xl font-bold text-red-600",children:t.expired}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Expired"})]}),e.jsxs("div",{className:"bg-card p-4 rounded-lg border",children:[e.jsx("div",{className:"text-2xl font-bold text-gray-600",children:t.failed}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Failed"})]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-3xl font-bold tracking-tight",children:"Domain List"}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs(g,{variant:"outline",onClick:N,disabled:d,children:[e.jsx(C,{className:`h-4 w-4 mr-2 ${d?"animate-spin":""}`}),d?"Rechecking...":"Recheck All"]}),e.jsx(z,{onExportComplete:s=>{console.log("Export completed:",s)}}),e.jsx($,{onImport:h,isLoading:D})]})]}),e.jsx(P,{domains:i,onToggleNotifications:f,onRefreshDomain:j,onDeleteDomains:v,onGroupOperationSuccess:b,language:"en"})]})}export{J as default};
