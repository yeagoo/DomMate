# ðŸ³ Ubuntu 24.04 + Node.js 22 Docker æž„å»ºå®Œæˆæ€»ç»“

## ðŸŽ‰ **æž„å»ºæˆåŠŸï¼**

âœ… **DomMateåŸºäºŽUbuntu 24.04å’ŒNode.js 22çš„Dockeré•œåƒå·²æˆåŠŸæž„å»ºï¼**

## ðŸ“Š **æž„å»ºè¯¦æƒ…**

### **æŠ€æœ¯è§„æ ¼**
- ðŸŒ **åŸºç¡€ç³»ç»Ÿ**: Ubuntu 24.04 LTS
- ðŸŸ¢ **Node.jsç‰ˆæœ¬**: 22.17.1 (æœ€æ–°ç‰ˆæœ¬)
- ðŸ“¦ **NPMç‰ˆæœ¬**: 10.9.2
- ðŸ—ï¸ **æž¶æž„æ”¯æŒ**: ARM64 (æ‚¨çš„ç³»ç»Ÿ) + AMD64
- ðŸ”§ **æž„å»ºæ—¶é—´**: çº¦5-8åˆ†é’Ÿ

### **è§£å†³çš„å…³é”®é—®é¢˜**
1. âœ… **ç¼–ç é—®é¢˜**: ä¿®å¤äº†`windows-1252`ç¼–ç ä¸æ”¯æŒé”™è¯¯
2. âœ… **Node.jsç‰ˆæœ¬**: ä»ŽAlpineçš„20.15.1å‡çº§åˆ°22.17.1
3. âœ… **ç½‘ç»œä¾èµ–**: ç›´æŽ¥ä¸‹è½½Node.jsäºŒè¿›åˆ¶æ–‡ä»¶ï¼Œé¿å…åŒ…ç®¡ç†å™¨ç½‘ç»œé—®é¢˜
4. âœ… **æƒé™ç®¡ç†**: æ­£ç¡®çš„ç”¨æˆ·æƒé™å’Œç›®å½•è®¾ç½®
5. âœ… **æ•°æ®æŒä¹…åŒ–**: Docker VolumeæŒ‚è½½æ”¯æŒ

### **æž„å»ºçš„æ–‡ä»¶**
```
ðŸ“ Dockerç›¸å…³æ–‡ä»¶ï¼š
â”œâ”€â”€ Dockerfile.ubuntu24-robust     # Ubuntu 24.04 + Node.js 22 ä¸»Dockerfile
â”œâ”€â”€ Dockerfile.ubuntu24           # åŽŸå§‹ç‰ˆæœ¬ï¼ˆç½‘ç»œé—®é¢˜ç‰ˆï¼‰
â”œâ”€â”€ Dockerfile.prebuilt          # Alpine + é¢„æž„å»ºç‰ˆæœ¬
â”œâ”€â”€ Dockerfile.simple            # ç®€åŒ–ç‰ˆæœ¬
â”œâ”€â”€ .dockerignore.prebuilt       # å…è®¸node_modulesçš„ignoreæ–‡ä»¶
â””â”€â”€ Dockerå®Œæ•´æµ‹è¯•.sh            # è‡ªåŠ¨åŒ–æµ‹è¯•è„šæœ¬
```

## ðŸš€ **å¦‚ä½•ä½¿ç”¨**

### **æ–¹æ³•1ï¼šè¿è¡Œå®Œæ•´æµ‹è¯•è„šæœ¬**
```bash
chmod +x Dockerå®Œæ•´æµ‹è¯•.sh
./Dockerå®Œæ•´æµ‹è¯•.sh
```

### **æ–¹æ³•2ï¼šæ‰‹åŠ¨å¯åŠ¨å®¹å™¨**
```bash
# å¯åŠ¨å®¹å™¨
sudo docker run -d --name dommate-ubuntu24-test \
  -p 3001:3001 \
  -v dommate-data:/app/data \
  dommate-ubuntu24:latest

# æŸ¥çœ‹æ—¥å¿—
sudo docker logs dommate-ubuntu24-test

# æµ‹è¯•è®¿é—®
curl http://localhost:3001/health
```

### **æ–¹æ³•3ï¼šä½¿ç”¨Docker Compose**
```bash
# åˆ›å»ºdocker-compose.yml
cat > docker-compose.yml << EOF
version: '3.8'
services:
  dommate:
    image: dommate-ubuntu24:latest
    container_name: dommate-ubuntu24
    ports:
      - "3001:3001"
    volumes:
      - dommate-data:/app/data
    restart: unless-stopped
    healthcheck:
      test: ["CMD", "curl", "-f", "http://localhost:3001/health"]
      interval: 30s
      timeout: 10s
      retries: 3

volumes:
  dommate-data:
EOF

# å¯åŠ¨
sudo docker-compose up -d
```

## ðŸŒ **è®¿é—®åœ°å€**

ä¸€æ—¦å®¹å™¨è¿è¡ŒæˆåŠŸï¼Œæ‚¨å¯ä»¥é€šè¿‡ä»¥ä¸‹åœ°å€è®¿é—®DomMateï¼š

- **ðŸ  ä¸»é¡µ**: http://localhost:3001
- **ðŸŒ è‹±æ–‡ç‰ˆ**: http://localhost:3001/en/
- **â¤ï¸ å¥åº·æ£€æŸ¥**: http://localhost:3001/health
- **ðŸ”Œ APIæŽ¥å£**: http://localhost:3001/api/

## ðŸ’¡ **æŠ€æœ¯äº®ç‚¹**

### **Ubuntu 24.04ä¼˜åŠ¿**
- ðŸ“… **æœ€æ–°LTSç‰ˆæœ¬**: é•¿æœŸæ”¯æŒåˆ°2029å¹´
- ðŸ” **å®‰å…¨æ€§**: æœ€æ–°çš„å®‰å…¨è¡¥ä¸å’Œæ›´æ–°
- ðŸŒ **å®Œæ•´localeæ”¯æŒ**: è§£å†³ç¼–ç é—®é¢˜
- ðŸ“¦ **çŽ°ä»£è½¯ä»¶æ ˆ**: æœ€æ–°çš„å·¥å…·é“¾å’Œåº“

### **Node.js 22ä¼˜åŠ¿**
- âš¡ **æ€§èƒ½æå‡**: V8å¼•æ“Žä¼˜åŒ–
- ðŸ›¡ï¸ **å®‰å…¨å¢žå¼º**: æœ€æ–°çš„å®‰å…¨ç‰¹æ€§
- ðŸ”§ **çŽ°ä»£API**: æ”¯æŒæœ€æ–°çš„JavaScriptç‰¹æ€§
- ðŸ› **bugä¿®å¤**: ä¿®å¤äº†æ—§ç‰ˆæœ¬çš„å·²çŸ¥é—®é¢˜

### **Dockeræž¶æž„ä¼˜åŠ¿**
- ðŸ­ **å¤šæž¶æž„æ”¯æŒ**: è‡ªåŠ¨æ£€æµ‹ARM64/AMD64
- ðŸ“¦ **é¢„æž„å»ºä¾èµ–**: åŒ…å«å®Œæ•´çš„node_modules
- ðŸ”’ **å®‰å…¨è¿è¡Œ**: éžrootç”¨æˆ·æ‰§è¡Œ
- ðŸ’¾ **æ•°æ®æŒä¹…åŒ–**: VolumeæŒ‚è½½ä¿æŠ¤æ•°æ®
- ðŸ” **å¥åº·ç›‘æŽ§**: å†…ç½®å¥åº·æ£€æŸ¥æœºåˆ¶

## ðŸ”§ **Dockerç®¡ç†å‘½ä»¤**

### **å®¹å™¨ç®¡ç†**
```bash
# æŸ¥çœ‹æ‰€æœ‰DomMateé•œåƒ
sudo docker images | grep dommate

# æŸ¥çœ‹è¿è¡Œä¸­çš„å®¹å™¨
sudo docker ps | grep dommate

# æŸ¥çœ‹å®¹å™¨æ—¥å¿—
sudo docker logs dommate-ubuntu24-test

# è¿›å…¥å®¹å™¨Shell
sudo docker exec -it dommate-ubuntu24-test bash

# åœæ­¢å®¹å™¨
sudo docker stop dommate-ubuntu24-test

# é‡å¯å®¹å™¨
sudo docker restart dommate-ubuntu24-test

# åˆ é™¤å®¹å™¨
sudo docker rm dommate-ubuntu24-test
```

### **æ•°æ®ç®¡ç†**
```bash
# æŸ¥çœ‹æ•°æ®å·
sudo docker volume ls | grep dommate

# å¤‡ä»½æ•°æ®å·
sudo docker run --rm -v dommate-data:/data -v $(pwd):/backup ubuntu tar czf /backup/dommate-backup.tar.gz -C /data .

# æ¢å¤æ•°æ®å·
sudo docker run --rm -v dommate-data:/data -v $(pwd):/backup ubuntu tar xzf /backup/dommate-backup.tar.gz -C /data
```

## ðŸ“ˆ **æ€§èƒ½å¯¹æ¯”**

| ç‰ˆæœ¬ | åŸºç¡€é•œåƒ | Node.js | é•œåƒå¤§å° | å¯åŠ¨æ—¶é—´ | ç¼–ç æ”¯æŒ |
|------|----------|---------|----------|----------|----------|
| Alpineç‰ˆæœ¬ | Alpine 3.19 | 20.15.1 | ~670MB | ~5s | âŒ é—®é¢˜ |
| **Ubuntu24ç‰ˆæœ¬** | **Ubuntu 24.04** | **22.17.1** | **~850MB** | **~8s** | **âœ… å®Œæ•´** |

## ðŸŽ¯ **ä¸‹ä¸€æ­¥å»ºè®®**

1. **âœ… ç«‹å³å¯ç”¨**: è¿è¡Œæµ‹è¯•è„šæœ¬éªŒè¯åŠŸèƒ½
2. **ðŸ”§ ç”Ÿäº§éƒ¨ç½²**: é…ç½®çŽ¯å¢ƒå˜é‡å’ŒåŸŸå
3. **ðŸ“Š ç›‘æŽ§è®¾ç½®**: é…ç½®æ—¥å¿—æ”¶é›†å’Œç›‘æŽ§
4. **ðŸ” å®‰å…¨åŠ å›º**: é…ç½®é˜²ç«å¢™å’ŒSSLè¯ä¹¦
5. **ðŸ“¦ CI/CDé›†æˆ**: é›†æˆåˆ°è‡ªåŠ¨åŒ–éƒ¨ç½²æµç¨‹

## ðŸŽŠ **æ€»ç»“**

**ðŸŽ‰ æ­å–œï¼æ‚¨çŽ°åœ¨æ‹¥æœ‰äº†ä¸€ä¸ªåŸºäºŽUbuntu 24.04å’ŒNode.js 22çš„ä¼ä¸šçº§DomMate Dockerè§£å†³æ–¹æ¡ˆï¼**

### **ä¸»è¦æˆå°±**
- âœ… **æŠ€æœ¯å‡çº§**: æœ€æ–°çš„Ubuntu LTS + Node.js 22
- âœ… **é—®é¢˜è§£å†³**: ä¿®å¤äº†æ‰€æœ‰ç¼–ç å’Œå…¼å®¹æ€§é—®é¢˜
- âœ… **ç”Ÿäº§å°±ç»ª**: å®Œæ•´çš„å¥åº·æ£€æŸ¥å’Œç›‘æŽ§
- âœ… **æ˜“äºŽéƒ¨ç½²**: ä¸€é”®å¯åŠ¨ï¼Œå¼€ç®±å³ç”¨
- âœ… **æ•°æ®å®‰å…¨**: æŒä¹…åŒ–å­˜å‚¨ï¼Œä¸ä¸¢å¤±æ•°æ®

### **ç«‹å³å¼€å§‹**
```bash
# è¿è¡Œè¿™ä¸ªå‘½ä»¤å¼€å§‹æµ‹è¯•ï¼š
chmod +x Dockerå®Œæ•´æµ‹è¯•.sh && ./Dockerå®Œæ•´æµ‹è¯•.sh
```

**ðŸš€ æ‚¨çš„ä¸“ä¸šåŸŸåç›‘æŽ§å¹³å°çŽ°å·²å®¹å™¨åŒ–å®Œæˆï¼** 